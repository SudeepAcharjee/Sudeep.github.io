{"version":3,"file":"index.js","sources":["../src/constants.ts","../src/utils.ts","../src/index.tsx"],"sourcesContent":["import { ThemeInput } from './types';\n\nexport const API_URL = 'https://github-contributions-api.jogruber.de/v4/';\n\n// GitHub theme\nexport const DEFAULT_THEME: ThemeInput = {\n  light: ['#ebedf0', '#9be9a8', '#40c463', '#30a14e', '#216e39'],\n  dark: ['#161b22', '#0e4429', '#006d32', '#26a641', '#39d353'],\n};\n","import { Props } from './index';\nimport { Activity } from './types';\n\nexport const transformData = (\n  data: Array<Activity>,\n  transformFn?: Props['transformData'],\n): Array<Activity> => {\n  if (typeof transformFn !== 'function') {\n    return data;\n  }\n\n  const transformedData = transformFn(data);\n\n  if (!Array.isArray(transformedData)) {\n    throw Error(\n      `Passed function transformData must return a list of Day objects.`,\n    );\n  }\n\n  if (transformedData.length > 0) {\n    const testObj = transformedData[0];\n\n    if (typeof testObj.count !== 'number' || testObj.count < 0) {\n      throw Error(\n        `Required property \"count: number\" missing or invalid. Got: ${testObj.count}`,\n      );\n    }\n\n    if (!/\\d{4}-\\d{2}-\\d{2}/.test(testObj.date)) {\n      throw Error(\n        `Required property \"date: YYYY-MM-DD\" missing or invalid. Got: ${testObj.date}`,\n      );\n    }\n\n    if (\n      typeof testObj.level !== 'number' ||\n      testObj.level < 0 ||\n      testObj.level > 4\n    ) {\n      throw Error(\n        `Required property \"level: 0 | 1 | 2 | 3 | 4\" missing or invalid: Got: ${testObj.level}.`,\n      );\n    }\n  }\n\n  return transformedData;\n};\n","'use client';\n\nimport React, {\n  FunctionComponent,\n  useCallback,\n  useEffect,\n  useState,\n} from 'react';\nimport Calendar, {\n  type Props as ActivityCalendarProps,\n  Skeleton,\n} from 'react-activity-calendar';\n\nimport { API_URL, DEFAULT_THEME } from './constants';\nimport {\n  Activity,\n  ApiErrorResponse,\n  ApiResponse,\n  ThemeInput,\n  Year,\n} from './types';\nimport { transformData } from './utils';\n\nexport interface Props extends Omit<ActivityCalendarProps, 'data' | 'theme'> {\n  username: string;\n  errorMessage?: string;\n  theme?: ThemeInput;\n  throwOnError?: boolean;\n  transformData?: (data: Array<Activity>) => Array<Activity>;\n  transformTotalCount?: boolean;\n  year?: Year;\n}\n\nasync function fetchCalendarData(\n  username: string,\n  year: Year,\n): Promise<ApiResponse> {\n  const response = await fetch(`${API_URL}${username}?y=${year}`);\n  const data: ApiResponse | ApiErrorResponse = await response.json();\n\n  if (!response.ok) {\n    throw Error(\n      `Fetching GitHub contribution data for \"${username}\" failed: ${(data as ApiErrorResponse).error}`,\n    );\n  }\n\n  return data as ApiResponse;\n}\nconst GitHubCalendar: FunctionComponent<Props> = ({\n  username,\n  year = 'last',\n  labels,\n  transformData: transformFn,\n  transformTotalCount = true,\n  throwOnError = false,\n  errorMessage = `Error â€“ Fetching GitHub contribution data for \"${username}\" failed.`,\n  ...props\n}) => {\n  const [data, setData] = useState<ApiResponse | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  const fetchData = useCallback(() => {\n    setLoading(true);\n    setError(null);\n    fetchCalendarData(username, year)\n      .then(setData)\n      .catch(setError)\n      .finally(() => setLoading(false));\n  }, [username, year]);\n\n  useEffect(fetchData, [fetchData]);\n\n  // React error boundaries can't handle asynchronous code, so rethrow.\n  if (error) {\n    if (throwOnError) {\n      throw error;\n    } else {\n      return <div>{errorMessage}</div>;\n    }\n  }\n\n  if (loading || !data) {\n    return <Skeleton {...props} loading />;\n  }\n\n  const theme = props.theme ?? DEFAULT_THEME;\n\n  const defaultLabels = {\n    totalCount: `{{count}} contributions in ${\n      year === 'last' ? 'the last year' : '{{year}}'\n    }`,\n  };\n\n  const totalCount =\n    year === 'last' ? data.total['lastYear'] : data.total[year];\n\n  return (\n    <Calendar\n      data={transformData(data.contributions, transformFn)}\n      theme={theme}\n      labels={Object.assign({}, defaultLabels, labels)}\n      totalCount={transformFn && transformTotalCount ? undefined : totalCount}\n      {...props}\n      maxLevel={4}\n    />\n  );\n};\n\nexport default GitHubCalendar;\n"],"names":["API_URL","DEFAULT_THEME","light","dark","transformData","data","transformFn","transformedData","Array","isArray","Error","length","testObj","count","test","date","level","fetchCalendarData","username","year","response","fetch","json","ok","error","GitHubCalendar","labels","transformTotalCount","throwOnError","errorMessage","props","setData","useState","loading","setLoading","setError","fetchData","useCallback","then","catch","finally","useEffect","React","createElement","Skeleton","_extends","theme","defaultLabels","totalCount","total","Calendar","contributions","Object","assign","undefined","maxLevel"],"mappings":"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"}